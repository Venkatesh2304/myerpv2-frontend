(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,59583,e=>{"use strict";var a=e.i(17395),t=e.i(88841),l=e.i(15253);function i(e){let i,s,r,n,d=(0,t.c)(8);return d[0]!==e?({className:i,...s}=e,d[0]=e,d[1]=i,d[2]=s):(i=d[1],s=d[2]),d[3]!==i?(r=(0,l.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",i),d[3]=i,d[4]=r):r=d[4],d[5]!==s||d[6]!==r?(n=(0,a.jsx)("div",{"data-slot":"card",className:r,...s}),d[5]=s,d[6]=r,d[7]=n):n=d[7],n}function s(e){let i,s,r,n,d=(0,t.c)(8);return d[0]!==e?({className:i,...s}=e,d[0]=e,d[1]=i,d[2]=s):(i=d[1],s=d[2]),d[3]!==i?(r=(0,l.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",i),d[3]=i,d[4]=r):r=d[4],d[5]!==s||d[6]!==r?(n=(0,a.jsx)("div",{"data-slot":"card-header",className:r,...s}),d[5]=s,d[6]=r,d[7]=n):n=d[7],n}function r(e){let i,s,r,n,d=(0,t.c)(8);return d[0]!==e?({className:i,...s}=e,d[0]=e,d[1]=i,d[2]=s):(i=d[1],s=d[2]),d[3]!==i?(r=(0,l.cn)("leading-none font-semibold",i),d[3]=i,d[4]=r):r=d[4],d[5]!==s||d[6]!==r?(n=(0,a.jsx)("div",{"data-slot":"card-title",className:r,...s}),d[5]=s,d[6]=r,d[7]=n):n=d[7],n}function n(e){let i,s,r,n,d=(0,t.c)(8);return d[0]!==e?({className:i,...s}=e,d[0]=e,d[1]=i,d[2]=s):(i=d[1],s=d[2]),d[3]!==i?(r=(0,l.cn)("text-muted-foreground text-sm",i),d[3]=i,d[4]=r):r=d[4],d[5]!==s||d[6]!==r?(n=(0,a.jsx)("div",{"data-slot":"card-description",className:r,...s}),d[5]=s,d[6]=r,d[7]=n):n=d[7],n}function d(e){let i,s,r,n,d=(0,t.c)(8);return d[0]!==e?({className:i,...s}=e,d[0]=e,d[1]=i,d[2]=s):(i=d[1],s=d[2]),d[3]!==i?(r=(0,l.cn)("px-6",i),d[3]=i,d[4]=r):r=d[4],d[5]!==s||d[6]!==r?(n=(0,a.jsx)("div",{"data-slot":"card-content",className:r,...s}),d[5]=s,d[6]=r,d[7]=n):n=d[7],n}e.s(["Card",()=>i,"CardContent",()=>d,"CardDescription",()=>n,"CardHeader",()=>s,"CardTitle",()=>r])},83160,e=>{"use strict";var a=e.i(92355),t=e.i(58690),l=e.i(31769),i=e.i(17395),s=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let s=(0,l.createSlot)(`Primitive.${t}`),r=a.forwardRef((e,a)=>{let{asChild:l,...r}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,i.jsx)(l?s:t,{...r,ref:a})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function r(e,a){e&&t.flushSync(()=>e.dispatchEvent(a))}e.s(["Primitive",()=>s,"dispatchDiscreteCustomEvent",()=>r])},44960,e=>{"use strict";var a=e.i(17395),t=e.i(88841),l=e.i(15253);function i(e){let i,s,r,n,d,c=(0,t.c)(10);return c[0]!==e?({className:i,type:r,...s}=e,c[0]=e,c[1]=i,c[2]=s,c[3]=r):(i=c[1],s=c[2],r=c[3]),c[4]!==i?(n=(0,l.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",i),c[4]=i,c[5]=n):n=c[5],c[6]!==s||c[7]!==n||c[8]!==r?(d=(0,a.jsx)("input",{type:r,"data-slot":"input",className:n,...s}),c[6]=s,c[7]=n,c[8]=r,c[9]=d):d=c[9],d}e.s(["Input",()=>i])},21292,e=>{"use strict";var a=e.i(17395),t=e.i(88841),l=e.i(92355),i=e.i(83160),s=l.forwardRef((e,t)=>(0,a.jsx)(i.Primitive.label,{...e,ref:t,onMouseDown:a=>{a.target.closest("button, input, select, textarea")||(e.onMouseDown?.(a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));s.displayName="Label";var r=e.i(15253);function n(e){let l,i,n,d,c=(0,t.c)(8);return c[0]!==e?({className:l,...i}=e,c[0]=e,c[1]=l,c[2]=i):(l=c[1],i=c[2]),c[3]!==l?(n=(0,r.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",l),c[3]=l,c[4]=n):n=c[4],c[5]!==i||c[6]!==n?(d=(0,a.jsx)(s,{"data-slot":"label",className:n,...i}),c[5]=i,c[6]=n,c[7]=d):d=c[7],d}e.s(["Label",()=>n],21292)},38781,e=>{"use strict";var a=e.i(17395),t=e.i(88841),l=e.i(92355),i=e.i(20438),s=e.i(59583),r=e.i(57073),n=e.i(11869),d=e.i(49086),c=e.i(30581),o=e.i(42589),u=e.i(21292),m=e.i(27799);function h(){let e,l=(0,t.c)(1);return l[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(r.CaptchaProvider,{children:(0,a.jsx)(x,{})}),l[0]=e):e=l[0],e}function x(){let[e,t]=(0,l.useState)(""),[h,x]=(0,l.useState)("all"),[p,f]=(0,l.useState)(null),[b,j]=(0,l.useState)(!1),[g,v]=(0,l.useState)(!1),[y,T]=(0,l.useState)(!1),[N,C]=(0,l.useState)(!1),[w,S]=(0,l.useState)(!1),R=(0,l.useRef)(!1),P=(0,r.useCaptcha)(),_=(0,l.useRef)(0),F=(0,l.useCallback)(async(e,a)=>{let t=++_.current;j(!0);try{let l=await (0,n.requestWithCaptcha)({url:"/einvoice/stats",method:"POST",headers:{"Content-Type":"application/json"},data:{period:e,type:a}},P);if(t!==_.current)return;let i=l.data?.stats;i&&"object"==typeof i&&Array.isArray(i)?f(i):f([])}catch(e){if(t!==_.current)return;alert(e?.message??"Request failed"),f([])}finally{t===_.current&&j(!1)}},[P]);(0,l.useEffect)(()=>{if(!e)return void f(null);if(!R.current){R.current=!0,S(!0),(async()=>{try{await (0,n.requestWithCaptcha)({url:"/einvoice/reload",method:"POST",headers:{"Content-Type":"application/json"},data:{period:e}},P),await F(e,h)}catch(e){alert(e?.message??"Initial IRN load failed")}finally{S(!1)}})();return}F(e,h)},[e,h]);let H=Array.isArray(p)&&p.length>0&&p.some(e=>Number(e.not_filed)>0),D=async a=>{let t=a.data,l=a.headers&&a.headers["content-disposition"]||"",i=/filename\*=UTF-8''([^;]+)|filename="([^"]+)"/i.exec(l||"");console.log("download filename match:",i?.[1]||i?.[2],a.headers);let s=decodeURIComponent(i?.[1]||i?.[2]||`einvoice_${e}.xlsx`),r=URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download=s,document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(r)},I=async()=>{if(H){v(!0);try{let a=await (0,n.requestWithCaptcha)({url:"/einvoice/file",method:"POST",headers:{"Content-Type":"application/json"},data:{period:e,type:h},responseType:"blob"},P);await D(a),await F(e,h)}catch(e){alert(e?.message??"Filing failed")}finally{v(!1)}}},A=async()=>{if(e){T(!0);try{let a=await c.default.post("/einvoice/excel",{period:e,type:h},{responseType:"blob"});await D(a)}catch(e){alert(e?.message??"Download failed")}finally{T(!1)}}},L=async()=>{if(e){C(!0);try{let a=await (0,n.requestWithCaptcha)({url:"/einvoice/pdf",method:"POST",headers:{"Content-Type":"application/json"},responseType:"blob",data:{period:e,type:h}},P);await D(a)}catch(e){console.log(e),alert(e?.message??"Download failed")}finally{C(!1)}}},k=async()=>{if(e){S(!0);try{await (0,n.requestWithCaptcha)({url:"/einvoice/reload",method:"POST",headers:{"Content-Type":"application/json"},data:{period:e}},P)}catch(e){alert("Load IRNs failed"),console.log(e)}finally{await F(e,h),S(!1)}}};return(0,a.jsx)("div",{className:"container mx-auto max-w-xl p-4",children:(0,a.jsxs)(s.Card,{children:[(0,a.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,a.jsx)(s.CardTitle,{children:"E-Invoice"}),(0,a.jsx)(i.Button,{variant:"outline",size:"sm",onClick:k,disabled:!e||w||b,children:w?"Loading IRN...":"Load IRN"})]}),(0,a.jsxs)(s.CardContent,{children:[(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsx)(d.default,{className:"flex-1",onPeriodChange:e=>t(e)}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)(u.Label,{htmlFor:"einvoice-type",children:"Type"}),(0,a.jsxs)(m.Select,{value:h,onValueChange:x,children:[(0,a.jsx)(m.SelectTrigger,{id:"einvoice-type",children:(0,a.jsx)(m.SelectValue,{placeholder:"Select type"})}),(0,a.jsxs)(m.SelectContent,{children:[(0,a.jsx)(m.SelectItem,{value:"all",children:"All"}),(0,a.jsx)(m.SelectItem,{value:"damage",children:"Damage"}),(0,a.jsx)(m.SelectItem,{value:"sales",children:"Sales"}),(0,a.jsx)(m.SelectItem,{value:"salesreturn",children:"SalesReturn"})]})]})]})]})}),b||w?(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsxs)(o.Table,{children:[(0,a.jsx)(o.TableHeader,{children:(0,a.jsxs)(o.TableRow,{children:[(0,a.jsx)(o.TableHead,{children:"Company"}),(0,a.jsx)(o.TableHead,{children:"Type"}),(0,a.jsx)(o.TableHead,{className:"text-right",children:"Amount (Not Filed)"}),(0,a.jsx)(o.TableHead,{className:"text-right",children:"Filed"}),(0,a.jsx)(o.TableHead,{className:"text-right",children:"Not Filed"})]})}),(0,a.jsx)(o.TableBody,{children:Array.from({length:5}).map((e,t)=>(0,a.jsxs)(o.TableRow,{children:[(0,a.jsx)(o.TableCell,{children:(0,a.jsx)("div",{className:"h-4 rounded bg-muted animate-pulse"})}),(0,a.jsx)(o.TableCell,{children:(0,a.jsx)("div",{className:"h-4 rounded bg-muted animate-pulse"})}),(0,a.jsx)(o.TableCell,{className:"text-right",children:(0,a.jsx)("div",{className:"h-4 rounded bg-muted animate-pulse"})}),(0,a.jsx)(o.TableCell,{className:"text-right",children:(0,a.jsx)("div",{className:"h-4 rounded bg-muted animate-pulse"})}),(0,a.jsx)(o.TableCell,{className:"text-right",children:(0,a.jsx)("div",{className:"h-4 rounded bg-muted animate-pulse"})})]},t))})]})}):Array.isArray(p)&&(0,a.jsx)("div",{className:"mt-6",children:0===p.length?(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"No data"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(o.Table,{children:[(0,a.jsx)(o.TableHeader,{children:(0,a.jsxs)(o.TableRow,{children:[(0,a.jsx)(o.TableHead,{children:"Company"}),(0,a.jsx)(o.TableHead,{children:"Type"}),(0,a.jsx)(o.TableHead,{className:"text-right",children:"Amount (Not Filed)"}),(0,a.jsx)(o.TableHead,{className:"text-right",children:"Filed"}),(0,a.jsx)(o.TableHead,{className:"text-right",children:"Not Filed"})]})}),(0,a.jsx)(o.TableBody,{children:p.map(e=>(0,a.jsxs)(o.TableRow,{className:0==e.not_filed?"text-gray-600":"",children:[(0,a.jsx)(o.TableCell,{children:e.company}),(0,a.jsx)(o.TableCell,{children:e.type}),(0,a.jsx)(o.TableCell,{className:"text-right",children:e.amt}),(0,a.jsx)(o.TableCell,{className:`text-right  ${e.not_filed>0&&"font-medium text-green-600"}`,children:e.filed}),(0,a.jsx)(o.TableCell,{className:`text-right  ${e.not_filed>0&&"font-medium text-red-600"}`,children:e.not_filed})]},e.company+e.type))})]}),(0,a.jsx)("div",{className:"mt-4 flex items-center justify-between",children:"all"===h?(0,a.jsx)("span",{className:"text-gray-500 font-bold text-sm",children:"Please go to respective invoice types to file einvoice"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Button,{variant:"outline",onClick:L,disabled:"damage"!=h||N||!p?.length,children:N?"Downloading...":"Download PDF"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.Button,{variant:"outline",onClick:A,disabled:y||!p?.length,children:y?"Downloading...":"Download Excel"}),H&&(0,a.jsx)(i.Button,{onClick:I,disabled:g,children:g?"Filing...":"File E-Invoice"})]})]})})]})})]})]})})}e.s(["default",()=>h])}]);